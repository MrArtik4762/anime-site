global:
  # SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  smtp_smarthost: 'localhost:587'
  smtp_from: 'alerts@anime-site.com'
  smtp_auth_username: 'alerts@anime-site.com'
  smtp_auth_password: 'your-smtp-password'

# –§–∞–π–ª —Å —à–∞–±–ª–æ–Ω–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
templates:
  - '/etc/alertmanager/templates/*.tmpl'

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
route:
  # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –ø–æ –∏–º–µ–Ω–∏
  group_by: ['alertname', 'severity']
  
  # –ñ–¥–µ–º 10 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø–µ—Ä–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ
  group_wait: 10s
  
  # –ñ–¥–µ–º 10 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Ç–æ–π –∂–µ –≥—Ä—É–ø–ø–µ
  group_interval: 10s
  
  # –ü–æ–≤—Ç–æ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 1 —á–∞—Å –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
  repeat_interval: 1h
  
  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ receiver 'web.hook'
  receiver: 'web.hook'
  
  # –ú–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
  routes:
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ–º
    - match:
        severity: critical
      receiver: 'critical'
      continue: true
    
    # –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º DevOps
    - match:
        alertname: "DatabaseConnectionIssues"
      receiver: 'devops'
      continue: true
    
    # –û—à–∏–±–∫–∏ API –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º
    - match:
        alertname: "HighErrorRate"
      receiver: 'developers'
      continue: true

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
receivers:
  # –í–µ–±—Ö—É–∫ –¥–ª—è Slack
  - name: 'web.hook'
    email_configs:
      - to: 'team@anime-site.com'
        subject: 'Anime Site Alert'
        body: |
          {{ range .Alerts }}
          Alert: {{ .Annotations.summary }}
          Description: {{ .Annotations.description }}
          Labels: {{ .Labels }}
          {{ end }}
    
    slack_configs:
      - api_url: 'YOUR_SLACK_WEBHOOK_URL'
        channel: '#alerts'
        title: 'Anime Site Alert'
        text: '{{ range .Alerts }}{{ .Annotations.summary }}{{ end }}'
        color: '{{ if eq .Labels.severity "critical" }}danger{{ else if eq .Labels.severity "warning" }}warning{{ else }}good{{ end }}'
    
    # Pushover —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    pushover_configs:
      - user_key: 'YOUR_PUSHOVER_USER_KEY'
        api_token: 'YOUR_PUSHOVER_API_TOKEN'
        title: 'Anime Site Alert'
        message: '{{ range .Alerts }}{{ .Annotations.summary }}{{ end }}'

  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
  - name: 'critical'
    email_configs:
      - to: 'emergency@anime-site.com'
        subject: 'CRITICAL: {{ .GroupLabels.alertname }}'
        body: |
          {{ range .Alerts }}
          CRITICAL ALERT: {{ .Annotations.summary }}
          Description: {{ .Annotations.description }}
          {{ end }}
    
    slack_configs:
      - api_url: 'YOUR_CRITICAL_SLACK_WEBHOOK_URL'
        channel: '#critical-alerts'
        title: 'üö® CRITICAL ALERT'
        text: '{{ range .Alerts }}{{ .Annotations.summary }}{{ end }}'
        color: 'danger'
    
    # Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    telegram_configs:
      - bot_token: 'YOUR_TELEGRAM_BOT_TOKEN'
        chat_id: 'YOUR_TELEGRAM_CHAT_ID'
        message: |
          üö® CRITICAL ALERT: {{ .GroupLabels.alertname }}
          {{ range .Alerts }}
          {{ .Annotations.summary }}
          {{ end }}

  # DevOps –∫–æ–º–∞–Ω–¥–∞
  - name: 'devops'
    email_configs:
      - to: 'devops@anime-site.com'
        subject: 'DevOps Alert: {{ .GroupLabels.alertname }}'
        body: |
          {{ range .Alerts }}
          DevOps Alert: {{ .Annotations.summary }}
          Description: {{ .Annotations.description }}
          {{ end }}

  # –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏
  - name: 'developers'
    email_configs:
      - to: 'developers@anime-site.com'
        subject: 'Developer Alert: {{ .GroupLabels.alertname }}'
        body: |
          {{ range .Alerts }}
          Developer Alert: {{ .Annotations.summary }}
          Description: {{ .Annotations.description }}
          {{ end }}

# –ò–Ω–≥–∏–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ) –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
inhibit_rules:
  # –ü–æ–¥–∞–≤–ª—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è, –µ—Å–ª–∏ —Å–µ—Ä–≤–∏—Å —É–∂–µ –≤ –Ω–µ—Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'dev', 'instance']

# –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 120 —á–∞—Å–æ–≤ (5 –¥–Ω–µ–π)
# –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
# retention: 120h